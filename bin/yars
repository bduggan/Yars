#!/usr/bin/env perl

use File::Basename 'dirname';
use File::Spec;

use lib join '/', File::Spec->splitdir(dirname(__FILE__)), 'lib';
use lib join '/', File::Spec->splitdir(dirname(__FILE__)), '..', 'lib';
use lib join '/', File::Spec->splitdir(dirname(__FILE__)), '..', 'lib', 'perl';

use Yars;
use Yars::Balancer;
use Clustericious::Commands;

use strict;
use warnings;

$ENV{MOJO_APP} ||= 'Yars';

&main;

sub main {
    my $cmd = $ARGV[0];
    my $app = Yars->new();
    Yars::Balancer->start_balancers($app) if $cmd && $cmd eq 'start';
    Yars::Balancer->stop_balancers($app) if $cmd && $cmd eq 'stop';
    $app = Clustericious::Commands->start;
    $app;
}



